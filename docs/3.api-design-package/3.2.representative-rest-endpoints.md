# 3. API design

## 3.2 Representative REST endpoints

---

| Method | Path                        | Description                            | Roles             |
| ------ | --------------------------- | -------------------------------------- | ----------------- |
| POST   | `/auth/login`               | log in and get session/token           | all               |
| GET    | `/requests`                 | list requests (filter by role/query)   | employee/tech/sup |
| POST   | `/requests`                 | create a new maintenance request       | employee          |
| GET    | `/requests/{id}`            | get details + activity for one request | employee/tech/sup |
| PATCH  | `/requests/{id}`            | update status, assignment, or notes    | technician/sup    |
| GET    | `/reports/open-vs-resolved` | simple summary for supervisors         | supervisor        |

### example – create request

**Request**

```http
POST /requests
Content-Type: application/json
Authorization: Bearer <token>
```

```json
{
  "title": "Air conditioner leaking",
  "description": "Water on the floor near AC unit in room 3B.",
  "location_id": "loc_3b",
  "priority": "high"
}
```

**Response**

```http
201 Created
```

```json
{
  "id": "req_123",
  "title": "Air conditioner leaking",
  "status": "open",
  "priority": "high",
  "location_id": "loc_3b",
  "created_by": "user_emp_1",
  "assigned_technician": null,
  "created_at": "2025-03-01T10:15:00Z"
}
```

### example – assign technician

```http
PATCH /requests/req_123
Content-Type: application/json
Authorization: Bearer <supervisor-token>
```

```json
{
  "assigned_technician": "user_tech_5"
}
```

**Response**

```http
200 OK
```

```json
{
  "id": "req_123",
  "status": "open",
  "assigned_technician": "user_tech_5",
  "updated_at": "2025-03-01T11:00:00Z"
}
```